<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jogo de Consci√™ncia Sil√°bica</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Comic Sans MS', 'Chalkboard SE', sans-serif;
        }
        body {
            background: linear-gradient(135deg, #6ecbf5 0%, #4a6fa5 100%);
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            color: #333;
        }
        .container {
            background-color: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            width: 95%;
            max-width: 800px;
            padding: 25px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        h1 {
            color: #4a6fa5;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            font-size: 2.2rem;
        }
        h2 {
            color: #2c4a76;
            margin: 15px 0;
        }
        .screen {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .active {
            display: block;
        }
        .input-group {
            margin: 15px 0;
        }
        input, select {
            padding: 14px;
            margin: 10px 0;
            border: 2px solid #c4d7f2;
            border-radius: 12px;
            width: 80%;
            font-size: 16px;
            transition: all 0.3s;
            background: #f9fcff;
        }
        input:focus, select:focus {
            border-color: #4a6fa5;
            outline: none;
            box-shadow: 0 0 0 3px rgba(74, 111, 165, 0.2);
        }
        button {
            background: linear-gradient(to bottom, #4a6fa5, #3a5a80);
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 17px;
            margin: 12px 8px;
            transition: all 0.3s;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
            background: linear-gradient(to bottom, #5a7fb5, #4a6a90);
        }
        button:active {
            transform: translateY(1px);
        }
        .emoji {
            font-size: 60px;
            margin: 20px 0;
            animation: bounce 1.5s infinite alternate;
        }
        @keyframes bounce {
            from { transform: translateY(0px); }
            to { transform: translateY(-10px); }
        }
        .timer-container {
            height: 16px;
            background-color: #e0e0e0;
            border-radius: 8px;
            margin: 20px 0;
            overflow: hidden;
            position: relative;
        }
        .timer-progress {
            height: 100%;
            background: linear-gradient(to right, #4caf50, #2e7d32);
            width: 100%;
            transition: width 1s linear;
            border-radius: 8px;
        }
        .timer-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-weight: bold;
            color: #333;
            font-size: 12px;
        }
        .feedback {
            margin: 20px 0;
            padding: 20px;
            border-radius: 12px;
            background-color: #f8f9fa;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            transition: all 0.3s;
        }
        .correct {
            background-color: #e8f5e9;
            border-left: 5px solid #4caf50;
        }
        .incorrect {
            background-color: #ffebee;
            border-left: 5px solid #f44336;
        }
        .score-display {
            font-size: 28px;
            font-weight: bold;
            color: #4a6fa5;
            margin: 25px 0;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        .level-badge {
            display: inline-block;
            padding: 8px 20px;
            border-radius: 25px;
            color: white;
            margin: 15px 0;
            font-weight: bold;
            font-size: 18px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .easy {
            background: linear-gradient(to right, #4caf50, #2e7d32);
        }
        .medium {
            background: linear-gradient(to right, #ff9800, #ef6c00);
        }
        .hard {
            background: linear-gradient(to right, #f44336, #c62828);
        }
        .option-btn {
            background: linear-gradient(to bottom, #f5f5f5, #e0e0e0);
            color: #333;
            border: 2px solid #ddd;
            padding: 12px 18px;
            margin: 8px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 16px;
            flex: 1 0 45%;
            max-width: 250px;
        }
        .option-btn:hover {
            background: linear-gradient(to bottom, #e0e0e0, #d5d5d5);
        }
        .option-btn.selected {
            background: linear-gradient(to bottom, #4a6fa5, #3a5a80);
            color: white;
            border-color: #4a6fa5;
            transform: scale(1.03);
        }
        .options-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            margin: 20px 0;
            gap: 10px;
        }
        .input-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 20px 0;
            gap: 15px;
        }
        .input-container input {
            width: 65%;
            margin: 0;
        }
        .question-type {
            font-size: 20px;
            color: #4a6fa5;
            margin: 15px 0;
            font-weight: bold;
        }
        .word-display {
            font-size: 32px;
            color: #2c4a76;
            margin: 15px 0;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        .progress-container {
            width: 100%;
            background-color: #e0e0e0;
            border-radius: 10px;
            margin: 20px 0;
            overflow: hidden;
            height: 20px;
        }
        .progress-bar {
            height: 100%;
            background: linear-gradient(to right, #4caf50, #2e7d32);
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 10px;
        }
        .report-status {
            margin: 20px 0;
            padding: 15px;
            border-radius: 10px;
            background-color: #e8f5e9;
            color: #2e7d32;
            display: none;
            font-weight: bold;
        }
        .hidden {
            display: none;
        }
        .answer-list {
            text-align: left;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            max-height: 200px;
            overflow-y: auto;
        }
        .answer-list li {
            margin: 8px 0;
            padding: 8px;
            border-bottom: 1px solid #e0e0e0;
        }
        .stats-container {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        .stat-box {
            background: linear-gradient(to bottom, #4a6fa5, #3a5a80);
            color: white;
            padding: 15px;
            border-radius: 10px;
            min-width: 120px;
            margin: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .stat-number {
            font-size: 28px;
            font-weight: bold;
            margin: 5px 0;
        }
        .stat-label {
            font-size: 14px;
        }
        @media (max-width: 768px) {
            .container {
                width: 100%;
                padding: 15px;
                border-radius: 15px;
            }
            h1 {
                font-size: 1.8rem;
            }
            .input-container {
                flex-direction: column;
            }
            .input-container input {
                width: 100%;
                margin-bottom: 10px;
            }
            .options-container {
                flex-direction: column;
                align-items: center;
            }
            .option-btn {
                width: 100%;
                max-width: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Tela de In√≠cio -->
        <div id="start-screen" class="screen active">
            <h1><i class="fas fa-book-reader"></i> Jogo de Consci√™ncia Sil√°bica</h1>
            <p>Vamos brincar com as s√≠labas das palavras! <i class="fas fa-smile"></i></p>
            <div class="emoji">üìù ‚úèÔ∏è üéì</div>
            
            <div class="input-group">
                <input type="text" id="player-name" placeholder="Digite seu nome">
            </div>
            
            <div class="input-group">
                <select id="player-age">
                    <option value="">Selecione sua idade</option>
                    <option value="8">8 anos</option>
                    <option value="9">9 anos</option>
                    <option value="10">10 anos</option>
                    <option value="11">11 anos</option>
                    <option value="12">12 anos</option>
                    <option value="13">13 anos</option>
                    <option value="14">14 anos</option>
                </select>
            </div>
            
            <div class="input-group">
                <select id="school-year">
                    <option value="">Selecione seu ano escolar</option>
                    <option value="1">1¬∫ Ano</option>
                    <option value="2">2¬∫ Ano</option>
                    <option value="3">3¬∫ Ano</option>
                    <option value="4">4¬∫ Ano</option>
                    <option value="5">5¬∫ Ano</option>
                    <option value="6">6¬∫ Ano</option>
                    <option value="7">7¬∫ Ano</option>
                    <option value="8">8¬∫ Ano</option>
                    <option value="9">9¬∫ Ano</option>
                </select>
            </div>
            
            <button id="start-btn"><i class="fas fa-play"></i> Come√ßar o Jogo!</button>
        </div>

        <!-- Tela do Jogo -->
        <div id="game-screen" class="screen">
            <h2 id="level-title">N√≠vel F√°cil</h2>
            <div class="level-badge easy"><i class="fas fa-star"></i> F√°cil</div>
            
            <div class="progress-container">
                <div class="progress-bar" id="level-progress"></div>
            </div>
            
            <div class="emoji" id="word-emoji">üê±</div>
            <h3>Separar a palavra em s√≠labas:</h3>
            <div class="word-display" id="current-word">gato</div>
            
            <div id="question-type" class="question-type">Digite a separa√ß√£o sil√°bica:</div>
            
            <div class="input-container" id="input-container">
                <input type="text" id="syllable-input" placeholder="Exemplo: ga-to">
                <button id="check-btn"><i class="fas fa-check"></i> Verificar</button>
            </div>
            
            <div class="options-container" id="options-container">
                <!-- Op√ß√µes ser√£o geradas dinamicamente -->
            </div>
            
            <div class="timer-container">
                <div id="timer-progress" class="timer-progress"></div>
                <div class="timer-text" id="timer-text">20s</div>
            </div>
            
            <div id="feedback" class="feedback"></div>
        </div>

        <!-- Tela de Resultado -->
        <div id="result-screen" class="screen">
            <h1>Parab√©ns, <span id="player-name-result"></span>! <i class="fas fa-trophy"></i></h1>
            <div class="score-display">Sua pontua√ß√£o: <span id="score-result">0</span></div>
            
            <h3>Seu n√≠vel de jogo: <span id="final-level">F√°cil</span></h3>
            
            <div class="stats-container">
                <div class="stat-box">
                    <div class="stat-number" id="correct-count">0</div>
                    <div class="stat-label">Acertos</div>
                </div>
                <div class="stat-box">
                    <div class="stat-number" id="incorrect-count">0</div>
                    <div class="stat-label">Erros</div>
                </div>
                <div class="stat-box">
                    <div class="stat-number" id="accuracy-rate">0%</div>
                    <div class="stat-label">Precis√£o</div>
                </div>
            </div>
            
            <div id="report-status" class="report-status">
                <i class="fas fa-spinner fa-spin"></i> Enviando relat√≥rio para o professor...
            </div>
            
            <button id="restart-btn"><i class="fas fa-redo"></i> Jogar Novamente</button>
            <button id="download-btn"><i class="fas fa-download"></i> Baixar Resultados</button>
        </div>
    </div>

    <!-- Formul√°rio oculto para envio por email -->
    <form id="email-form" class="hidden" action="https://formsubmit.co/psicopedagogolucas@gmail.com" method="POST">
        <input type="hidden" name="_subject" value="Relat√≥rio do Jogo de Consci√™ncia Sil√°bica">
        <input type="hidden" name="_template" value="table">
        <input type="hidden" name="_next" value="#">
        <input type="hidden" name="nome" id="form-nome">
        <input type="hidden" name="idade" id="form-idade">
        <input type="hidden" name="ano" id="form-ano">
        <input type="hidden" name="pontuacao" id="form-pontuacao">
        <input type="hidden" name="nivel" id="form-nivel">
        <input type="hidden" name="relatorio" id="form-relatorio">
        <input type="hidden" name="grafico" id="form-grafico">
        <input type="hidden" name="_captcha" value="false">
    </form>

    <script>
        // Vari√°veis globais
        let playerName = '';
        let playerAge = 0;
        let schoolYear = 0;
        let currentLevel = 'easy';
        let score = 0;
        let currentWordIndex = 0;
        let timerInterval;
        let timeLeft = 20;
        let gameWords = [];
        let correctAnswers = [];
        let incorrectAnswers = [];
        let currentQuestionType = 'input'; // 'input' ou 'options'
        
        // Banco de palavras por n√≠vel e ano escolar
        const wordsDatabase = {
            easy: {
                1: [
                    {word: "p√©", emoji: "ü¶∂", syllables: ["p√©"]},
                    {word: "p√°", emoji: "ü™ì", syllables: ["p√°"]},
                    {word: "lua", emoji: "üåô", syllables: ["lu", "a"]},
                    {word: "bola", emoji: "‚öΩ", syllables: ["bo", "la"]},
                    {word: "gato", emoji: "üê±", syllables: ["ga", "to"]}
                ],
                2: [
                    {word: "casa", emoji: "üè†", syllables: ["ca", "sa"]},
                    {word: "l√°pis", emoji: "‚úèÔ∏è", syllables: ["l√°", "pis"]},
                    {word: "flor", emoji: "üå∫", syllables: ["flor"]},
                    {word: "mesa", emoji: "ü™ë", syllables: ["me", "sa"]},
                    {word: "livro", emoji: "üìñ", syllables: ["li", "vro"]}
                ],
                3: [
                    {word: "caderno", emoji: "üìì", syllables: ["ca", "der", "no"]},
                    {word: "janela", emoji: "ü™ü", syllables: ["ja", "ne", "la"]},
                    {word: "√°rvore", emoji: "üå≥", syllables: ["√°r", "vo", "re"]},
                    {word: "computador", emoji: "üíª", syllables: ["com", "pu", "ta", "dor"]},
                    {word: "ventilador", emoji: "üåÄ", syllables: ["ven", "ti", "la", "dor"]}
                ]
            },
            medium: {
                4: [
                    {word: "professor", emoji: "üë®‚Äçüè´", syllables: ["pro", "fes", "sor"]},
                    {word: "borboleta", emoji: "ü¶ã", syllables: ["bor", "bo", "le", "ta"]},
                    {word: "telefone", emoji: "üì±", syllables: ["te", "le", "fo", "ne"]},
                    {word: "biblioteca", emoji: "üìö", syllables: ["bi", "blio", "te", "ca"]},
                    {word: "experimento", emoji: "üß™", syllables: ["ex", "pe", "ri", "men", "to"]}
                ],
                5: [
                    {word: "avi√£o", emoji: "‚úàÔ∏è", syllables: ["a", "vi", "√£o"]},
                    {word: "elefante", emoji: "üêò", syllables: ["e", "le", "fan", "te"]},
                    {word: "helic√≥ptero", emoji: "üöÅ", syllables: ["he", "li", "c√≥p", "te", "ro"]},
                    {word: "constela√ß√£o", emoji: "üåå", syllables: ["cons", "te", "la", "√ß√£o"]},
                    {word: "administra√ß√£o", emoji: "üè¢", syllables: ["ad", "mi", "nis", "tra", "√ß√£o"]}
                ],
                6: [
                    {word: "planet√°rio", emoji: "ü™ê", syllables: ["pla", "ne", "t√°", "rio"]},
                    {word: "arque√≥logo", emoji: "üîç", syllables: ["ar", "que", "√≥", "lo", "go"]},
                    {word: "paralelep√≠pedo", emoji: "üß±", syllables: ["pa", "ra", "le", "le", "p√≠", "pe", "do"]},
                    {word: "fotoss√≠ntese", emoji: "üåø", syllables: ["fo", "to", "ss√≠n", "te", "se"]},
                    {word: "term√¥metro", emoji: "üå°Ô∏è", syllables: ["ter", "m√¥", "me", "tro"]}
                ]
            },
            hard: {
                7: [
                    {word: "ecossistema", emoji: "üåé", syllables: ["e", "cos", "sis", "te", "ma"]},
                    {word: "matem√°tica", emoji: "üßÆ", syllables: ["ma", "te", "m√°", "ti", "ca"]},
                    {word: "astronauta", emoji: "üë®‚ÄçüöÄ", syllables: ["as", "tro", "nau", "ta"]},
                    {word: "desenvolvimento", emoji: "üìà", syllables: ["de", "sen", "vol", "vi", "men", "to"]},
                    {word: "responsabilidade", emoji: "ü§ù", syllables: ["res", "pon", "sa", "bi", "li", "da", "de"]}
                ],
                8: [
                    {word: "identifica√ß√£o", emoji: "üÜî", syllables: ["i", "den", "ti", "fi", "ca", "√ß√£o"]},
                    {word: "multidisciplinar", emoji: "üéì", syllables: ["mul", "ti", "dis", "ci", "pli", "nar"]},
                    {word: "inconstitucional", emoji: "‚öñÔ∏è", syllables: ["in", "cons", "ti", "tu", "ci", "o", "nal"]},
                    {word: "internacionaliza√ß√£o", emoji: "üåê", syllables: ["in", "ter", "na", "ci", "o", "na", "li", "za", "√ß√£o"]},
                    {word: "interdisciplinaridade", emoji: "üî¨", syllables: ["in", "ter", "dis", "ci", "pli", "na", "ri", "da", "de"]}
                ],
                9: [
                    {word: "incompreensibilidade", emoji: "‚ùì", syllables: ["in", "com", "pre", "en", "si", "bi", "li", "da", "de"]},
                    {word: "descaracteriza√ß√£o", emoji: "üé≠", syllables: ["des", "ca", "rac", "te", "ri", "za", "√ß√£o"]},
                    {word: "contraindica√ß√£o", emoji: "‚ö†Ô∏è", syllables: ["con", "tra", "in", "di", "ca", "√ß√£o"]},
                    {word: "inconstitucionalissimamente", emoji: "üß†", syllables: ["in", "cons", "ti", "tu", "ci", "o", "na", "lis", "si", "ma", "men", "te"]},
                    {word: "otorrinolaringologista", emoji: "üë®‚Äç‚öïÔ∏è", syllables: ["o", "tor", "ri", "no", "la", "rin", "go", "lo", "gis", "ta"]}
                ]
            }
        };

        // Elementos DOM
        const startScreen = document.getElementById('start-screen');
        const gameScreen = document.getElementById('game-screen');
        const resultScreen = document.getElementById('result-screen');
        const startBtn = document.getElementById('start-btn');
        const checkBtn = document.getElementById('check-btn');
        const restartBtn = document.getElementById('restart-btn');
        const downloadBtn = document.getElementById('download-btn');
        const playerNameInput = document.getElementById('player-name');
        const playerAgeSelect = document.getElementById('player-age');
        const schoolYearSelect = document.getElementById('school-year');
        const wordEmoji = document.getElementById('word-emoji');
        const currentWord = document.getElementById('current-word');
        const syllableInput = document.getElementById('syllable-input');
        const feedback = document.getElementById('feedback');
        const timerProgress = document.getElementById('timer-progress');
        const timerText = document.getElementById('timer-text');
        const levelTitle = document.getElementById('level-title');
        const levelProgress = document.getElementById('level-progress');
        const playerNameResult = document.getElementById('player-name-result');
        const scoreResult = document.getElementById('score-result');
        const finalLevel = document.getElementById('final-level');
        const correctCount = document.getElementById('correct-count');
        const incorrectCount = document.getElementById('incorrect-count');
        const accuracyRate = document.getElementById('accuracy-rate');
        const reportStatus = document.getElementById('report-status');
        const optionsContainer = document.getElementById('options-container');
        const inputContainer = document.getElementById('input-container');
        const questionType = document.getElementById('question-type');
        const emailForm = document.getElementById('email-form');
        const formNome = document.getElementById('form-nome');
        const formIdade = document.getElementById('form-idade');
        const formAno = document.getElementById('form-ano');
        const formPontuacao = document.getElementById('form-pontuacao');
        const formNivel = document.getElementById('form-nivel');
        const formRelatorio = document.getElementById('form-relatorio');
        const formGrafico = document.getElementById('form-grafico');

        // Event Listeners
        startBtn.addEventListener('click', startGame);
        checkBtn.addEventListener('click', checkAnswer);
        restartBtn.addEventListener('click', restartGame);
        downloadBtn.addEventListener('click', downloadResults);
        syllableInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                checkAnswer();
            }
        });

        // Iniciar o jogo
        function startGame() {
            playerName = playerNameInput.value.trim();
            playerAge = parseInt(playerAgeSelect.value);
            schoolYear = parseInt(schoolYearSelect.value);
            
            if (!playerName || !playerAge || !schoolYear) {
                alert('Por favor, preencha todas as informa√ß√µes!');
                return;
            }
            
            // Determinar n√≠vel inicial baseado no ano escolar
            if (schoolYear <= 3) {
                currentLevel = 'easy';
            } else if (schoolYear <= 6) {
                currentLevel = 'medium';
            } else {
                currentLevel = 'hard';
            }
            
            // Carregar palavras para o n√≠vel e ano escolar
            gameWords = wordsDatabase[currentLevel][schoolYear] || wordsDatabase[currentLevel][Object.keys(wordsDatabase[currentLevel])[0]];
            
            startScreen.classList.remove('active');
            gameScreen.classList.add('active');
            
            updateLevelDisplay();
            loadWord();
        }

        // Atualizar display do n√≠vel
        function updateLevelDisplay() {
            levelTitle.textContent = `N√≠vel ${currentLevel === 'easy' ? 'F√°cil' : currentLevel === 'medium' ? 'M√©dio' : 'Dif√≠cil'}`;
            
            // Atualizar badge de n√≠vel
            const badge = document.querySelector('.level-badge');
            badge.className = 'level-badge ' + currentLevel;
            badge.innerHTML = `<i class="fas fa-${currentLevel === 'easy' ? 'star' : currentLevel === 'medium' ? 'medal' : 'crown'}"></i> ${currentLevel === 'easy' ? 'F√°cil' : currentLevel === 'medium' ? 'M√©dio' : 'Dif√≠cil'}`;
        }

        // Carregar palavra atual
        function loadWord() {
            if (currentWordIndex >= gameWords.length) {
                // Avan√ßar para o pr√≥ximo n√≠vel ou finalizar
                if (currentLevel === 'easy') {
                    currentLevel = 'medium';
                    currentWordIndex = 0;
                    gameWords = wordsDatabase.medium[schoolYear] || wordsDatabase.medium[4];
                    updateLevelDisplay();
                    levelProgress.style.width = '50%';
                    loadWord();
                    return;
                } else if (currentLevel === 'medium') {
                    currentLevel = 'hard';
                    currentWordIndex = 0;
                    gameWords = wordsDatabase.hard[schoolYear] || wordsDatabase.hard[7];
                    updateLevelDisplay();
                    levelProgress.style.width = '100%';
                    loadWord();
                    return;
                } else {
                    endGame();
                    return;
                }
            }
            
            const currentWordData = gameWords[currentWordIndex];
            wordEmoji.textContent = currentWordData.emoji;
            currentWord.textContent = currentWordData.word;
            syllableInput.value = '';
            feedback.textContent = '';
            feedback.className = 'feedback';
            
            // Atualizar barra de progresso
            levelProgress.style.width = `${((currentWordIndex / gameWords.length) * 100) / (currentLevel === 'easy' ? 3 : currentLevel === 'medium' ? 1.5 : 1)}%`;
            
            // Alternar entre digitar e selecionar (para palavras maiores, priorizar sele√ß√£o)
            currentQuestionType = currentWordData.word.length > 8 || Math.random() > 0.5 ? 'options' : 'input';
            
            if (currentQuestionType === 'input') {
                questionType.textContent = "Digite a separa√ß√£o sil√°bica:";
                inputContainer.style.display = "flex";
                optionsContainer.style.display = "none";
                syllableInput.focus();
            } else {
                questionType.textContent = "Selecione a separa√ß√£o correta:";
                inputContainer.style.display = "none";
                optionsContainer.style.display = "flex";
                generateOptions(currentWordData.syllables, currentWordData.word);
            }
            
            // Iniciar timer
            timeLeft = 20;
            timerProgress.style.width = '100%';
            timerText.textContent = '20s';
            clearInterval(timerInterval);
            
            timerInterval = setInterval(function() {
                timeLeft--;
                timerProgress.style.width = (timeLeft / 20 * 100) + '%';
                timerText.textContent = timeLeft + 's';
                
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    handleTimeout();
                }
            }, 1000);
        }

        // Gerar op√ß√µes de resposta
        function generateOptions(correctSyllables, word) {
            optionsContainer.innerHTML = '';
            const correctAnswer = correctSyllables.join('-');
            
            // Criar op√ß√µes incorretas
            let options = [correctAnswer];
            
            // Op√ß√£o com n√∫mero errado de s√≠labas
            if (correctSyllables.length > 1) {
                let wrongSyllables = [...correctSyllables];
                wrongSyllables.pop();
                options.push(wrongSyllables.join('-'));
            }
            
            // Op√ß√£o com separa√ß√£o errada
            if (correctSyllables.length > 2) {
                let wrongSyllables = [...correctSyllables];
                // Juntar duas s√≠labas
                const joinIndex = Math.floor(Math.random() * (wrongSyllables.length - 1));
                wrongSyllables[joinIndex] = wrongSyllables[joinIndex] + wrongSyllables[joinIndex + 1];
                wrongSyllables.splice(joinIndex + 1, 1);
                options.push(wrongSyllables.join('-'));
            }
            
            // Op√ß√£o com h√≠fen no lugar errado
            if (word.length > 3) {
                const wrongPlace = word.split('').map((c, i) => i === 1 ? '-' : c).join('');
                if (!options.includes(wrongPlace)) {
                    options.push(wrongPlace);
                }
            }
            
            // Embaralhar op√ß√µes
            options = shuffleArray(options);
            
            // Criar bot√µes de op√ß√£o
            options.forEach(option => {
                const button = document.createElement('button');
                button.className = 'option-btn';
                button.textContent = option;
                button.addEventListener('click', function() {
                    // Desselecionar outros bot√µes
                    document.querySelectorAll('.option-btn').forEach(btn => {
                        btn.classList.remove('selected');
                    });
                    // Selecionar este bot√£o
                    this.classList.add('selected');
                    // Verificar resposta
                    checkOptionAnswer(option);
                });
                optionsContainer.appendChild(button);
            });
        }

        // Embaralhar array
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Verificar resposta para op√ß√µes
        function checkOptionAnswer(selectedOption) {
            clearInterval(timerInterval);
            
            const correctSyllables = gameWords[currentWordIndex].syllables;
            const correctAnswer = correctSyllables.join('-');
            
            if (selectedOption === correctAnswer) {
                // Resposta correta
                feedback.innerHTML = '<i class="fas fa-check-circle"></i> Parab√©ns! Voc√™ acertou! üéâ';
                feedback.className = 'feedback correct';
                score += 10;
                correctAnswers.push({
                    word: gameWords[currentWordIndex].word,
                    userAnswer: selectedOption,
                    correctAnswer: correctAnswer
                });
            } else {
                // Resposta incorreta
                feedback.innerHTML = `<i class="fas fa-times-circle"></i> Que pena! A separa√ß√£o correta √©: <strong>${correctAnswer}</strong><br>
                Porque: ${explainSyllabication(gameWords[currentWordIndex].word, correctSyllables)}`;
                feedback.className = 'feedback incorrect';
                incorrectAnswers.push({
                    word: gameWords[currentWordIndex].word,
                    userAnswer: selectedOption,
                    correctAnswer: correctAnswer
                });
            }
            
            currentWordIndex++;
            setTimeout(loadWord, 3000);
        }

        // Verificar resposta para input
        function checkAnswer() {
            clearInterval(timerInterval);
            
            const userAnswer = syllableInput.value.trim().toLowerCase();
            const correctSyllables = gameWords[currentWordIndex].syllables;
            const correctAnswer = correctSyllables.join('-');
            
            if (userAnswer === correctAnswer) {
                // Resposta correta
                feedback.innerHTML = '<i class="fas fa-check-circle"></i> Parab√©ns! Voc√™ acertou! üéâ';
                feedback.className = 'feedback correct';
                score += 10;
                correctAnswers.push({
                    word: gameWords[currentWordIndex].word,
                    userAnswer: userAnswer,
                    correctAnswer: correctAnswer
                });
            } else {
                // Resposta incorreta
                feedback.innerHTML = `<i class="fas fa-times-circle"></i> Que pena! A separa√ß√£o correta √©: <strong>${correctAnswer}</strong><br>
                Porque: ${explainSyllabication(gameWords[currentWordIndex].word, correctSyllables)}`;
                feedback.className = 'feedback incorrect';
                incorrectAnswers.push({
                    word: gameWords[currentWordIndex].word,
                    userAnswer: userAnswer,
                    correctAnswer: correctAnswer
                });
            }
            
            currentWordIndex++;
            setTimeout(loadWord, 3000);
        }

        // Explicar a separa√ß√£o sil√°bica
        function explainSyllabication(word, syllables) {
            const explanations = {
                "p√©": "P√â: palavra monoss√≠laba (uma s√≥ s√≠laba).",
                "p√°": "P√Å: palavra monoss√≠laba (uma s√≥ s√≠laba).",
                "lua": "LU-A: diss√≠laba, separa√ß√£o entre a consoante e a vogal.",
                "bola": "BO-LA: diss√≠laba, s√≠labas can√¥nicas (consoante + vogal).",
                "gato": "GA-TO: diss√≠laba, s√≠labas can√¥nicas (consoante + vogal).",
                "casa": "CA-SA: diss√≠laba, s√≠labas can√¥nicas (consoante + vogal).",
                "l√°pis": "L√Å-PIS: diss√≠laba, s√≠laba t√¥nica na primeira s√≠laba.",
                "flor": "FLOR: monoss√≠laba, encontro consonantal 'fl' n√£o se separa.",
                "mesa": "ME-SA: diss√≠laba, s√≠labas can√¥nicas (consoante + vogal).",
                "livro": "LI-VRO: diss√≠laba, s√≠labas can√¥nicas (consoante + vogal).",
                "caderno": "CA-DER-NO: triss√≠laba, todas as s√≠labas s√£o can√¥nicas.",
                "janela": "JA-NE-LA: triss√≠laba, s√≠labas can√¥nicas (consoante + vogal).",
                "√°rvore": "√ÅR-VO-RE: triss√≠laba, d√≠grafo 'rv' n√£o se separa.",
                "computador": "COM-PU-TA-DOR: poliss√≠laba, s√≠labas can√¥nicas.",
                "ventilador": "VEN-TI-LA-DOR: poliss√≠laba, s√≠labas can√¥nicas.",
                "professor": "PRO-FES-SOR: triss√≠laba, 'ss' √© d√≠grafo e n√£o se separa.",
                "borboleta": "BOR-BO-LE-TA: poliss√≠laba, s√≠labas can√¥nicas.",
                "telefone": "TE-LE-FO-NE: poliss√≠laba, s√≠labas can√¥nicas.",
                "biblioteca": "BI-BLIO-TE-CA: poliss√≠laba, encontro consonantal 'bl' n√£o se separa.",
                "experimento": "EX-PE-RI-MEN-TO: poliss√≠laba, s√≠labas can√¥nicas.",
                "avi√£o": "A-VI-√ÉO: triss√≠laba, ditongo '√£o' n√£o se separa.",
                "elefante": "E-LE-FAN-TE: poliss√≠laba, s√≠labas can√¥nicas.",
                "helic√≥ptero": "HE-LI-C√ìP-TE-RO: poliss√≠laba, s√≠laba t√¥nica em 'c√≥p'.",
                "constela√ß√£o": "CONS-TE-LA-√á√ÉO: poliss√≠laba, ditongo '√£o' n√£o se separa.",
                "administra√ß√£o": "AD-MI-NIS-TRA-√á√ÉO: poliss√≠laba, ditongo '√£o' n√£o se separa.",
                "planet√°rio": "PLA-NE-T√Å-RIO: poliss√≠laba, s√≠laba t√¥nica em 't√°'.",
                "arque√≥logo": "AR-QUE-√ì-LO-GO: poliss√≠laba, s√≠laba t√¥nica em '√≥'.",
                "paralelep√≠pedo": "PA-RA-LE-LE-P√ç-PE-DO: poliss√≠laba, s√≠laba t√¥nica em 'p√≠'.",
                "fotoss√≠ntese": "FO-TOS-S√çN-TE-SE: poliss√≠laba, s√≠laba t√¥nica em 's√≠n'.",
                "term√¥metro": "TER-M√î-ME-TRO: poliss√≠laba, s√≠laba t√¥nica em 'm√¥'.",
                "ecossistema": "E-COS-SIS-TE-MA: poliss√≠laba, encontro consonantal 'ss' n√£o se separa.",
                "matem√°tica": "MA-TE-M√Å-TI-CA: poliss√≠laba, s√≠laba t√¥nica em 'm√°'.",
                "astronauta": "AS-TRO-NAU-TA: poliss√≠laba, ditongo 'au' n√£o se separa.",
                "desenvolvimento": "DE-SEN-VOL-VI-MEN-TO: poliss√≠laba, encontro consonantal 'lv' n√£o se separa.",
                "responsabilidade": "RES-PON-SA-BI-LI-DA-DE: poliss√≠laba, s√≠labas can√¥nicas.",
                "identifica√ß√£o": "I-DEN-TI-FI-CA-√á√ÉO: poliss√≠laba, ditongo '√£o' n√£o se separa.",
                "multidisciplinar": "MUL-TI-DIS-CI-PLI-NAR: poliss√≠laba, encontro consonantal 'sc' n√£o se separa.",
                "inconstitucional": "IN-CONS-TI-TU-CI-O-NAL: poliss√≠laba, encontro consonantal 'st' n√£o se separa.",
                "internacionaliza√ß√£o": "IN-TER-NA-CI-O-NA-LI-ZA-√á√ÉO: poliss√≠laba, ditongo '√£o' n√£o se separa.",
                "interdisciplinaridade": "IN-TER-DIS-CI-PLI-NA-RI-DA-DE: poliss√≠laba, encontro consonantal 'sc' n√£o se separa.",
                "incompreensibilidade": "IN-COM-PRE-EN-SI-BI-LI-DA-DE: poliss√≠laba, encontro consonantal 'pr' n√£o se separa.",
                "descaracteriza√ß√£o": "DES-CA-RAC-TE-RI-ZA-√á√ÉO: poliss√≠laba, ditongo '√£o' n√£o se separa.",
                "contraindica√ß√£o": "CON-TRA-IN-DI-CA-√á√ÉO: poliss√≠laba, ditongo '√£o' n√£o se separa.",
                "inconstitucionalissimamente": "IN-CONS-TI-TU-CI-O-NA-LIS-SI-MA-MEN-TE: poliss√≠laba, sufixo superlativo 'issimo' e adv√©rbial 'mente'.",
                "otorrinolaringologista": "O-TOR-RI-NO-LA-RIN-GO-LO-GIS-TA: poliss√≠laba, palavra composta por termos gregos."
            };
            
            return explanations[word] || `A palavra '${word}' se divide em ${syllables.length} s√≠labas: ${syllables.join('-')}.`;
        }

        // Tempo esgotado
        function handleTimeout() {
            const correctSyllables = gameWords[currentWordIndex].syllables;
            const correctAnswer = correctSyllables.join('-');
            feedback.innerHTML = `<i class="fas fa-hourglass-end"></i> Tempo esgotado! A separa√ß√£o correta √©: <strong>${correctAnswer}</strong><br>
            Porque: ${explainSyllabication(gameWords[currentWordIndex].word, correctSyllables)}`;
            feedback.className = 'feedback incorrect';
            
            incorrectAnswers.push({
                word: gameWords[currentWordIndex].word,
                userAnswer: '(Tempo esgotado)',
                correctAnswer: correctAnswer
            });
            
            currentWordIndex++;
            setTimeout(loadWord, 3000);
        }

        // Finalizar o jogo
        function endGame() {
            gameScreen.classList.remove('active');
            resultScreen.classList.add('active');
            
            playerNameResult.textContent = playerName;
            scoreResult.textContent = score;
            finalLevel.textContent = currentLevel === 'easy' ? 'F√°cil' : 
                                    currentLevel === 'medium' ? 'M√©dio' : 'Dif√≠cil';
            
            // Atualizar estat√≠sticas
            correctCount.textContent = correctAnswers.length;
            incorrectCount.textContent = incorrectAnswers.length;
            
            const total = correctAnswers.length + incorrectAnswers.length;
            const accuracy = total > 0 ? Math.round((correctAnswers.length / total) * 100) : 0;
            accuracyRate.textContent = `${accuracy}%`;
            
            // Enviar relat√≥rio por email
            sendReport();
        }

        // Enviar relat√≥rio por email usando FormSubmit
        function sendReport() {
            reportStatus.style.display = "block";
            
            // Determinar hip√≥tese de n√≠vel de alfabetiza√ß√£o
            let literacyLevel = "Alfab√©tico";
            const accuracy = correctAnswers.length / (correctAnswers.length + incorrectAnswers.length);
            
            if (accuracy < 0.3) {
                literacyLevel = "Pr√©-sil√°bico";
            } else if (accuracy < 0.6) {
                literacyLevel = "Sil√°bico";
            } else if (accuracy < 0.8) {
                literacyLevel = "Sil√°bico-alfab√©tico";
            }
            
            // Criar relat√≥rio detalhado
            const relatorio = `
                RELAT√ìRIO DO JOGO DE CONSCI√äNCIA SIL√ÅBICA
                ==========================================
                
                DADOS DO JOGADOR:
                - Nome: ${playerName}
                - Idade: ${playerAge} anos
                - Ano Escolar: ${schoolYear}¬∫ ano
                - Data: ${new Date().toLocaleString('pt-BR')}
                
                DESEMPENHO NO JOGO:
                - Pontua√ß√£o: ${score} pontos
                - N√≠vel Alcan√ßado: ${currentLevel === 'easy' ? 'F√°cil' : currentLevel === 'medium' ? 'M√©dio' : 'Dif√≠cil'}
                - Palavras Corretas: ${correctAnswers.length}
                - Palavras Incorretas: ${incorrectAnswers.length}
                - Taxa de Acerto: ${(accuracy * 100).toFixed(2)}%
                
                HIP√ìTESE DE N√çVEL DE ALFABETIZA√á√ÉO: ${literacyLevel}
                
                AN√ÅLISE DE DESEMPENHO POR ETAPA SIL√ÅBICA:
                - Monoss√≠labas: ${analyzeSyllableType(1)}
                - Diss√≠labas: ${analyzeSyllableType(2)}
                - Triss√≠labas: ${analyzeSyllableType(3)}
                - Poliss√≠labas: ${analyzeSyllableType(4)}
                
                PALAVRAS COM DIFICULDADE:
                ${incorrectAnswers.map(item => `- ${item.word}: Resposta="${item.userAnswer}", Correto="${item.correctAnswer}"`).join('\n                ')}
                
                INTERVEN√á√ïES PSICOPEDAG√ìGICAS SUGERIDAS:
                ${getInterventions(literacyLevel)}
            `;
            
            // Criar gr√°fico em formato texto (simulado)
            const grafico = createTextChart(accuracy, correctAnswers.length, incorrectAnswers.length);
            
            // Preencher o formul√°rio oculto
            formNome.value = playerName;
            formIdade.value = playerAge;
            formAno.value = schoolYear;
            formPontuacao.value = score;
            formNivel.value = currentLevel;
            formRelatorio.value = relatorio;
            formGrafico.value = grafico;
            
            // Enviar o formul√°rio
            emailForm.submit();
            
            // Atualizar status ap√≥s um tempo
            setTimeout(() => {
                reportStatus.innerHTML = '<i class="fas fa-check-circle"></i> Relat√≥rio enviado com sucesso!';
            }, 2000);
        }

        // Analisar desempenho por tipo sil√°bico
        function analyzeSyllableType(syllableCount) {
            const correct = correctAnswers.filter(item => item.correctAnswer.split('-').length === syllableCount).length;
            const incorrect = incorrectAnswers.filter(item => item.correctAnswer.split('-').length === syllableCount).length;
            const total = correct + incorrect;
            
            if (total === 0) return "Nenhuma palavra deste tipo";
            
            const percentage = (correct / total) * 100;
            return `${correct}/${total} acertos (${percentage.toFixed(1)}%)`;
        }

        // Obter interven√ß√µes psicopedag√≥gicas
        function getInterventions(level) {
            const interventions = {
                "Pr√©-sil√°bico": [
                    "Trabalhar com rimas e alitera√ß√µes para desenvolver consci√™ncia fonol√≥gica",
                    "Atividades de segmenta√ß√£o de palavras em s√≠labas com apoio visual e motor",
                    "Jogos de consci√™ncia fonol√≥gica: identificar sons iniciais e finais das palavras"
                ],
                "Sil√°bico": [
                    "Refor√ßar correspond√™ncia fonema-grafema atrav√©s de atividades l√∫dicas",
                    "Atividades de s√≠ntese e an√°lise sil√°bica com palavras familiares",
                    "Jogos de forma√ß√£o de palavras com s√≠labas m√≥veis e cart√µes"
                ],
                "Sil√°bico-alfab√©tico": [
                    "Trabalhar com palavras complexas que contenham encontros consonantais",
                    "Pr√°tica de leitura e escrita com textos curtos e contextualizados",
                    "Atividades de ortografia e regras contextuais de forma expl√≠cita"
                ],
                "Alfab√©tico": [
                    "Amplia√ß√£o de vocabul√°rio atrav√©s de leitura diversificada",
                    "Leitura e interpreta√ß√£o de textos mais complexos",
                    "Produ√ß√£o textual com foco na coes√£o, coer√™ncia e pontua√ß√£o"
                ]
            };
            
            return interventions[level].join('\n                ');
        }

        // Criar um gr√°fico em formato de texto (ASCII art)
        function createTextChart(accuracy, correct, incorrect) {
            const total = correct + incorrect;
            const correctBars = Math.round((correct / total) * 20);
            const incorrectBars = 20 - correctBars;
            
            return `
                DESEMPENHO DO ALUNO - GR√ÅFICO
                ----------------------------
                
                Pontua√ß√£o: ${score} pontos
                Taxa de Acerto: ${(accuracy * 100).toFixed(2)}%
                
                [GR√ÅFICO DE BARRAS]
                Corretas:   ${'‚ñà'.repeat(correctBars)} ${correct}/${total}
                Incorretas: ${'‚ñà'.repeat(incorrectBars)} ${incorrect}/${total}
                
                [GR√ÅFICO DE PIZZA SIMULADO]
                ‚óè‚óè‚óè‚óè‚óè‚óè‚óè‚óè‚óè‚óã‚óã‚óã 70% Corretas
                ‚óè‚óè‚óè‚óã‚óã‚óã‚óã‚óã‚óã‚óã‚óã‚óã 30% Incorretas
            `;
        }

        // Baixar resultados
        function downloadResults() {
            const resultData = {
                playerName,
                playerAge,
                schoolYear,
                score,
                level: currentLevel,
                correctAnswers,
                incorrectAnswers,
                date: new Date().toLocaleString()
            };
            
            // Determinar hip√≥tese de n√≠vel de alfabetiza√ß√£o
            let literacyLevel = "Alfab√©tico";
            const accuracy = correctAnswers.length / (correctAnswers.length + incorrectAnswers.length);
            
            if (accuracy < 0.3) {
                literacyLevel = "Pr√©-sil√°bico";
            } else if (accuracy < 0.6) {
                literacyLevel = "Sil√°bico";
            } else if (accuracy < 0.8) {
                literacyLevel = "Sil√°bico-alfab√©tico";
            }
            
            // Criar relat√≥rio detalhado
            const relatorio = `
                RELAT√ìRIO DO JOGO DE CONSCI√äNCIA SIL√ÅBICA
                ==========================================
                
                DADOS DO JOGADOR:
                - Nome: ${playerName}
                - Idade: ${playerAge} anos
                - Ano Escolar: ${schoolYear}¬∫ ano
                - Data: ${new Date().toLocaleString('pt-BR')}
                
                DESEMPENHO NO JOGO:
                - Pontua√ß√£o: ${score} pontos
                - N√≠vel Alcan√ßado: ${currentLevel === 'easy' ? 'F√°cil' : currentLevel === 'medium' ? 'M√©dio' : 'Dif√≠cil'}
                - Palavras Corretas: ${correctAnswers.length}
                - Palavras Incorretas: ${incorrectAnswers.length}
                - Taxa de Acerto: ${(accuracy * 100).toFixed(2)}%
                
                HIP√ìTESE DE N√çVEL DE ALFABETIZA√á√ÉO: ${literacyLevel}
                
                PALAVRAS COM DIFICULDADE:
                ${incorrectAnswers.map(item => `- ${item.word}: Resposta="${item.userAnswer}", Correto="${item.correctAnswer}"`).join('\n                ')}
            `;
            
            // Criar elemento para download
            const element = document.createElement('a');
            element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(relatorio));
            element.setAttribute('download', `relatorio-silabico-${playerName}-${new Date().toISOString().slice(0, 10)}.txt`);
            
            element.style.display = 'none';
            document.body.appendChild(element);
            
            element.click();
            
            document.body.removeChild(element);
        }

        // Reiniciar o jogo
        function restartGame() {
            resultScreen.classList.remove('active');
            startScreen.classList.add('active');
            
            // Resetar vari√°veis
            score = 0;
            currentWordIndex = 0;
            correctAnswers = [];
            incorrectAnswers = [];
            currentLevel = 'easy';
        }

        // Verificar se h√° erros de JavaScript
        window.addEventListener('error', function(e) {
            console.error('Erro JavaScript:', e.error);
            alert('Ocorreu um erro no jogo. Por favor, recarregue a p√°gina.');
        });

        // Inicializa√ß√£o do jogo
        window.addEventListener('load', function() {
            console.log('Jogo carregado com sucesso!');
        });
    </script>
</body>
</html>